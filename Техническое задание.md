**TRex-budget-bot** — Telegram-бот для учёта ежедневных трат.

### Описание идеи и цель проекта

Данный бот решает проблему фиксации ежедневных трат с помощью простых команд в приложении Telegram.
Цель — предоставить пользователю возможность увидеть свои расходы по категориям за определённые периоды. Это позволит составить семейный бюджет и вести учёт личных финансов в осознанном режиме.
Целевая аудитория — любой пользователь Telegram, который хочет взять свои траты под контроль.

### Функциональность (MVP)

**Базовые функции:**

- **Стартовое меню.** Краткое описание бота, вывод стартовых команд.

- **Помощь.** Подробное описание всех команд.

- **Добавление расхода.**

- **Управление категориями расходов.** Вывод списка категорий и возможность их переименования.

	- Переименование категории.

	- Установка псевдонима для категории.

- **Подведение итогов расходов.**

	- Общая сумма расходов (без разбивки по категориям) за текущий день, неделю, месяц.

	- Расходы за день с разбивкой по категориям, отсортированные по убыванию.

	- Расходы за неделю с разбивкой по категориям, отсортированные по убыванию.

	- Расходы за месяц с разбивкой по категориям, отсортированные по убыванию.


**Идеи для расширения функционала:**

- Добавление функционала установки бюджета для категорий (например, лимит на месяц).

- Разделение категорий на регулярные и нерегулярные траты.

- Добавление возможности просмотра списка трат, их редактирования и удаления.

- Добавление возможности выгрузки таблицы трат в Google Sheets.


### Команды бота

- **`/start`** — начало работы и стартовое меню. Содержит краткое описание и набор основных команд.

- **`/addCategory`** — добавление новой категории. После добавления предлагается ввести псевдоним для категории (короткое название, например, «еда» для категории «Продукты»). Псевдоним не обязателен, но его наличие упрощает ввод.

	- _Допустимые значения:_

		- Для **имени** — любой набор символов длиной до 255 символов.

		- Для **псевдонима** — любой набор символов _без пробелов_.

- **`/listCategories`** — вывод списка всех категорий. Через этот же интерфейс можно переименовать категорию или изменить её псевдоним.

- **`/addExpense`** — добавление расхода.

	- _Формат:_ `{Сумма} {Категория} [Описание]`

	- **`{Сумма}`** (обязательно):

		- _Допустимые форматы:_ `100`, `100.99`, `100,99`, `-100.99`'
        - Знак `-` игнорируется.

	- **`{Категория}`** (обязательно):

		- _Допустимые значения:_ полное имя категории (с учётом регистра, например, «Продукты») или её псевдоним (например, «еда»).

	- **`[Описание]`** (необязательно):

		- _Допустимые значения:_ любой набор символов длиной до 255 символов.

- **`/listCurrentExpense`** — вывод общей суммы расходов (без разбивки по категориям) за день, неделю, месяц.

- **`/detailedRecordsForDay`** — вывод итогов по категориям за текущий день. Сортировка по убыванию.

- **`/detailedRecordsForWeek`** — вывод итогов по категориям за текущую неделю. Сортировка по убыванию.

- **`/detailedRecordsForMonth`** — вывод итогов по категориям за текущий месяц. Сортировка по убыванию.


### Данные БД

**Сущности:**

- **Expense** (трата)
	- `amount` — сумма
	- `category` — категория
	- `date` — дата и время операции
	- `description` — описание
- **Category** (категория)
	- `name` — имя
	- `alias` — псевдоним
- **User** (пользователь)
	- `chatId` — уникальный идентификатор чата пользователя
	- `state` — текущее состояние (для FSM)
	- `updateId` — вспомогательное поле для обновления сущности
	  **База данных:**
- PostgreSQL
- Опционально SQLite для разработки

### Стек технологий

- Java 21
- Spring Boot 3
- TelegramBots API
- PostgreSQL
- Docker
- Docker Compose

### Архитектура приложения

- Бот будет работать в режиме **Long Polling**: приложение при старте регистрируется через API Telegram и периодически опрашивает сервер на наличие новых сообщений.

- **Обработка команд** будет реализована через паттерн **Command**. Каждая команда представлена в виде отдельного класса, что в дальнейшем позволит легко добавлять новую функциональность.

- **Слой логики.** В пакете `services` будут размещены классы и методы бизнес-логики (добавление расхода, получение итогов за период и т.д.).

- **Слой данных.** В пакете `repository` будут представлены классы и методы для взаимодействия с базой данных.

- **Пользователи.** Для хранения состояния и данных каждого пользователя будет использоваться отдельная таблица.

- **Внешние API.** В качестве дополнительного функционала планируется интеграция с Google Sheets API для выгрузки данных.

- **Логирование и обработка ошибок.** Будет реализована система логирования для отслеживания работы приложения и обработки исключений.

### Развертывание

- **Среда разработки.** Разработка и тестирование бота будут проводиться с использованием библиотеки TelegramBots (LongPolling) и JUnit.
- **Деплой.** Развёртывание бота будет выполняться на личном VPS-сервере в Docker-контейнере. Обеспечение круглосуточной доступности бота (24/7).